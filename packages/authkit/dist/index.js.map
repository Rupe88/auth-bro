{"version":3,"sources":["../src/index.ts","../src/services/jwt.ts","../src/services/password.ts","../src/services/oauth.ts","../src/services/email.ts","../src/utils/schema-generator.ts"],"sourcesContent":["import { Router, Request, Response, NextFunction } from 'express';\nimport { PrismaClient } from '@prisma/client';\nimport rateLimit from 'express-rate-limit';\nimport { AuthConfig, AuthRequest, AuthMiddlewareOptions, User, Role, AuthResult } from './types';\nimport { JWTService } from './services/jwt';\nimport { PasswordService } from './services/password';\nimport { OAuthService } from './services/oauth';\nimport { EmailService } from './services/email';\nimport { SchemaGenerator } from './utils/schema-generator';\n\nexport class AuthKit {\n  private prisma: PrismaClient;\n  private jwt: JWTService;\n  private password: PasswordService;\n  private oauth: OAuthService;\n  private email?: EmailService;\n  private config: AuthConfig;\n  private router: Router;\n\n  constructor(config: AuthConfig) {\n    this.prisma = config.prisma;\n    this.config = {\n      jwt: {\n        secret: config.secret,\n        accessTokenExpiry: '15m',\n        refreshTokenExpiry: '7d',\n        algorithm: 'HS256',\n        ...config.jwt,\n      },\n      strategies: {\n        local: true,\n        ...config.strategies,\n      },\n      security: {\n        bcryptRounds: 12,\n        rateLimiting: {\n          enabled: true,\n          maxAttempts: 5,\n          windowMs: 15 * 60 * 1000,\n        },\n        sessionMaxAge: 7 * 24 * 60 * 60 * 1000,\n        cookieSettings: {\n          httpOnly: true,\n          secure: false,\n          sameSite: 'lax',\n        },\n        ...config.security,\n      },\n      ...config,\n    };\n\n    this.jwt = new JWTService(this.config.jwt!);\n    this.password = new PasswordService(this.config.security!.bcryptRounds);\n    this.oauth = new OAuthService(this.prisma);\n\n    if (this.config.email) {\n      this.email = new EmailService(this.config.email);\n    }\n\n    this.router = Router();\n\n    this.setupOAuthStrategies();\n    this.setupRoutes();\n  }\n\n  /**\n   * Get the Express router with all auth routes\n   */\n  getRouter(): Router {\n    return this.router;\n  }\n\n  /**\n   * Register a new user\n   */\n  async register(data: {\n    email: string;\n    password: string;\n    name?: string;\n    phone?: string;\n  }): Promise<AuthResult> {\n    try {\n      // Validate password\n      const passwordValidation = this.password.validate(data.password);\n      if (!passwordValidation.valid) {\n        return {\n          success: false,\n          error: passwordValidation.errors.join(', '),\n        };\n      }\n\n      // Hash password\n      const hashedPassword = await this.password.hash(data.password);\n\n      // Create user\n      const user = await this.prisma.user.create({\n        data: {\n          email: data.email.toLowerCase(),\n          password: hashedPassword,\n          name: data.name,\n          phone: data.phone,\n        },\n      });\n\n      // Generate tokens\n      const tokens = this.jwt.generateTokenPair(user);\n\n      // Create session\n      await this.createSession(user.id, tokens.refreshToken);\n\n      // Call hook\n      if (this.config.hooks?.onUserCreated) {\n        await this.config.hooks.onUserCreated(user);\n      }\n\n      return {\n        success: true,\n        user,\n        accessToken: tokens.accessToken,\n        refreshToken: tokens.refreshToken,\n      };\n    } catch (error: any) {\n      if (error.code === 'P2002') {\n        return {\n          success: false,\n          error: 'User with this email already exists',\n        };\n      }\n\n      return {\n        success: false,\n        error: 'Registration failed',\n      };\n    }\n  }\n\n  /**\n   * Login user\n   */\n  async login(credentials: { email: string; password: string }): Promise<AuthResult> {\n    try {\n      // Find user\n      const user = await this.prisma.user.findUnique({\n        where: { email: credentials.email.toLowerCase() },\n      });\n\n      if (!user || !user.password) {\n        return {\n          success: false,\n          error: 'Invalid credentials',\n        };\n      }\n\n      // Verify password\n      const isValidPassword = await this.password.verify(credentials.password, user.password);\n      if (!isValidPassword) {\n        return {\n          success: false,\n          error: 'Invalid credentials',\n        };\n      }\n\n      // Update last login\n      await this.prisma.user.update({\n        where: { id: user.id },\n        data: { lastLoginAt: new Date() },\n      });\n\n      // Generate tokens\n      const tokens = this.jwt.generateTokenPair(user);\n\n      // Create session\n      await this.createSession(user.id, tokens.refreshToken);\n\n      // Call hook\n      if (this.config.hooks?.onLogin) {\n        const session = await this.getSessionByRefreshToken(tokens.refreshToken);\n        await this.config.hooks.onLogin(user, session);\n      }\n\n      return {\n        success: true,\n        user,\n        accessToken: tokens.accessToken,\n        refreshToken: tokens.refreshToken,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: 'Login failed',\n      };\n    }\n  }\n\n  /**\n   * Verify JWT token and get user\n   */\n  async verifyToken(token: string): Promise<User | null> {\n    try {\n      const decoded = this.jwt.verifyAccessToken(token);\n      if (!decoded) return null;\n\n      const user = await this.prisma.user.findUnique({\n        where: { id: decoded.userId },\n      });\n\n      return user;\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Refresh access token\n   */\n  async refreshToken(refreshToken: string): Promise<AuthResult> {\n    try {\n      const session = await this.getSessionByRefreshToken(refreshToken);\n      if (!session || session.expiresAt < new Date()) {\n        return {\n          success: false,\n          error: 'Invalid or expired refresh token',\n        };\n      }\n\n      const user = await this.prisma.user.findUnique({\n        where: { id: session.userId },\n      });\n\n      if (!user) {\n        return {\n          success: false,\n          error: 'User not found',\n        };\n      }\n\n      // Generate new tokens\n      const tokens = this.jwt.generateTokenPair(user);\n\n      // Update session with new refresh token\n      await this.prisma.session.update({\n        where: { id: session.id },\n        data: {\n          refreshToken: tokens.refreshToken,\n          expiresAt: new Date(Date.now() + this.config.security!.sessionMaxAge!),\n        },\n      });\n\n      return {\n        success: true,\n        user,\n        accessToken: tokens.accessToken,\n        refreshToken: tokens.refreshToken,\n      };\n    } catch (error) {\n      return {\n        success: false,\n        error: 'Token refresh failed',\n      };\n    }\n  }\n\n  /**\n   * Logout user (invalidate session)\n   */\n  async logout(refreshToken: string): Promise<boolean> {\n    try {\n      const session = await this.getSessionByRefreshToken(refreshToken);\n      if (session) {\n        await this.prisma.session.delete({\n          where: { id: session.id },\n        });\n\n        // Call hook\n        if (this.config.hooks?.onLogout) {\n          await this.config.hooks.onLogout(session.userId);\n        }\n      }\n\n      return true;\n    } catch (error) {\n      return false;\n    }\n  }\n\n  /**\n   * Middleware: Require authentication\n   */\n  requireAuth(options: AuthMiddlewareOptions = {}): (req: Request, res: Response, next: NextFunction) => void {\n    return (req: Request, res: Response, next: NextFunction) => {\n      (async () => {\n        try {\n          const token = this.extractToken(req);\n          if (!token) {\n            res.status(401).json({ error: 'No token provided' });\n            return;\n          }\n\n          const user = await this.verifyToken(token);\n          if (!user) {\n            res.status(401).json({ error: 'Invalid token' });\n            return;\n          }\n\n          // Check role requirements\n          if (options.role && user.role !== options.role) {\n            res.status(403).json({ error: 'Insufficient permissions' });\n            return;\n          }\n\n          if (options.roles && !options.roles.includes(user.role!)) {\n            res.status(403).json({ error: 'Insufficient permissions' });\n            return;\n          }\n\n          // Check email verification requirement\n          if (options.emailVerified && !user.emailVerified) {\n            res.status(403).json({ error: 'Email not verified' });\n            return;\n          }\n\n          (req as any).user = user;\n          next();\n        } catch (error) {\n          res.status(401).json({ error: 'Authentication failed' });\n        }\n      })();\n    };\n  }\n\n  /**\n   * Middleware: Optional authentication\n   */\n  optionalAuth(): (req: Request, res: Response, next: NextFunction) => void {\n    return (req: Request, res: Response, next: NextFunction) => {\n      (async () => {\n        try {\n          const token = this.extractToken(req);\n          if (token) {\n            const user = await this.verifyToken(token);\n            if (user) {\n              (req as any).user = user;\n            }\n          }\n          next();\n        } catch (error) {\n          // Ignore auth errors for optional auth\n          next();\n        }\n      })();\n    };\n  }\n\n  /**\n   * Extract token from request\n   */\n  private extractToken(req: Request): string | null {\n    // Check Authorization header\n    const authHeader = req.headers.authorization;\n    if (authHeader && authHeader.startsWith('Bearer ')) {\n      return authHeader.substring(7);\n    }\n\n    // Check cookies\n    const cookieToken = req.cookies?.accessToken;\n    if (cookieToken) {\n      return cookieToken;\n    }\n\n    return null;\n  }\n\n  /**\n   * Create session\n   */\n  private async createSession(userId: string, refreshToken: string): Promise<void> {\n    await this.prisma.session.create({\n      data: {\n        userId,\n        refreshToken,\n        expiresAt: new Date(Date.now() + this.config.security!.sessionMaxAge!),\n        userAgent: 'API', // TODO: Extract from request\n        ipAddress: '127.0.0.1', // TODO: Extract from request\n      },\n    });\n  }\n\n  /**\n   * Get session by refresh token\n   */\n  private async getSessionByRefreshToken(refreshToken: string) {\n    return this.prisma.session.findUnique({\n      where: { refreshToken },\n    });\n  }\n\n  /**\n   * Setup OAuth strategies\n   */\n  private setupOAuthStrategies(): void {\n    if (this.config.strategies?.google && typeof this.config.strategies.google === 'object') {\n      this.oauth.configureGoogle(this.config.strategies.google);\n    }\n\n    if (this.config.strategies?.github && typeof this.config.strategies.github === 'object') {\n      this.oauth.configureGitHub(this.config.strategies.github);\n    }\n  }\n\n  /**\n   * Setup Express routes\n   */\n  private setupRoutes(): void {\n    // Rate limiting\n    if (this.config.security?.rateLimiting?.enabled) {\n      const limiter = rateLimit({\n        windowMs: this.config.security.rateLimiting.windowMs,\n        max: this.config.security.rateLimiting.maxAttempts,\n        message: { error: 'Too many requests, please try again later' },\n      });\n      this.router.use('/login', limiter);\n      this.router.use('/register', limiter);\n    }\n\n    // Auth routes\n    this.router.post('/register', async (req: Request, res: Response) => {\n      const result = await this.register(req.body);\n      if (result.success) {\n        res.status(201).json(result);\n      } else {\n        res.status(400).json({ error: result.error });\n      }\n    });\n\n    this.router.post('/login', async (req: Request, res: Response) => {\n      const result = await this.login(req.body);\n      if (result.success) {\n        res.status(200).json(result);\n      } else {\n        res.status(401).json({ error: result.error });\n      }\n    });\n\n    this.router.post('/refresh', async (req: Request, res: Response) => {\n      const { refreshToken } = req.body;\n      const result = await this.refreshToken(refreshToken);\n      if (result.success) {\n        res.status(200).json(result);\n      } else {\n        res.status(401).json({ error: result.error });\n      }\n    });\n\n    this.router.post('/logout', async (req: Request, res: Response) => {\n      const { refreshToken } = req.body;\n      const success = await this.logout(refreshToken);\n      res.status(success ? 200 : 400).json({ success });\n    });\n\n    this.router.get('/me', this.requireAuth(), async (req: Request, res: Response) => {\n      const authReq = req as AuthRequest;\n      res.json({ user: authReq.user });\n    });\n\n    // Email verification routes\n    if (this.email) {\n      this.router.post('/verify-email/send', this.requireAuth(), async (req: Request, res: Response) => {\n        const authReq = req as AuthRequest;\n        const user = authReq.user!;\n        if (user.emailVerified) {\n          res.status(400).json({ error: 'Email already verified' });\n          return;\n        }\n\n        const token = EmailService.generateToken();\n        await this.prisma.verificationToken.create({\n          data: {\n            userId: user.id,\n            token,\n            type: 'EMAIL_VERIFICATION',\n            expiresAt: new Date(Date.now() + 24 * 60 * 60 * 1000), // 24 hours\n          },\n        });\n\n        const success = await this.email!.sendEmailVerification(user, token);\n        res.json({ success });\n      });\n\n      this.router.get('/verify-email/:token', async (req: Request, res: Response) => {\n        const { token } = req.params;\n\n        const verificationToken = await this.prisma.verificationToken.findUnique({\n          where: { token },\n          include: { user: true },\n        });\n\n        if (!verificationToken || verificationToken.type !== 'EMAIL_VERIFICATION') {\n          res.status(400).json({ error: 'Invalid token' });\n          return;\n        }\n\n        if (verificationToken.expiresAt < new Date()) {\n          res.status(400).json({ error: 'Token expired' });\n          return;\n        }\n\n        // Mark email as verified\n        await this.prisma.user.update({\n          where: { id: verificationToken.userId },\n          data: { emailVerified: true },\n        });\n\n        // Delete token\n        await this.prisma.verificationToken.delete({\n          where: { id: verificationToken.id },\n        });\n\n        // Call hook\n        if (this.config.hooks?.onEmailVerified) {\n          await this.config.hooks.onEmailVerified(verificationToken.user);\n        }\n\n        res.json({ success: true, message: 'Email verified successfully' });\n      });\n\n      // Password reset routes\n      this.router.post('/forgot-password', async (req: Request, res: Response) => {\n        const { email } = req.body;\n\n        if (!EmailService.isValidEmail(email)) {\n          res.status(400).json({ error: 'Invalid email format' });\n          return;\n        }\n\n        const user = await this.prisma.user.findUnique({\n          where: { email },\n        });\n\n        if (!user) {\n          // Don't reveal if email exists\n          res.json({ success: true, message: 'If the email exists, a reset link has been sent' });\n          return;\n        }\n\n        const token = EmailService.generateToken();\n        await this.prisma.verificationToken.create({\n          data: {\n            userId: user.id,\n            token,\n            type: 'PASSWORD_RESET',\n            expiresAt: new Date(Date.now() + 60 * 60 * 1000), // 1 hour\n          },\n        });\n\n        const success = await this.email!.sendPasswordReset(user, token);\n        res.json({ success });\n      });\n\n      this.router.post('/reset-password', async (req: Request, res: Response) => {\n        const { token, password } = req.body;\n\n        const verificationToken = await this.prisma.verificationToken.findUnique({\n          where: { token },\n          include: { user: true },\n        });\n\n        if (!verificationToken || verificationToken.type !== 'PASSWORD_RESET') {\n          res.status(400).json({ error: 'Invalid token' });\n          return;\n        }\n\n        if (verificationToken.expiresAt < new Date()) {\n          res.status(400).json({ error: 'Token expired' });\n          return;\n        }\n\n        // Validate new password\n        const passwordValidation = this.password.validate(password);\n        if (!passwordValidation.valid) {\n          res.status(400).json({ error: passwordValidation.errors.join(', ') });\n          return;\n        }\n\n        // Hash new password\n        const hashedPassword = await this.password.hash(password);\n\n        // Update password\n        await this.prisma.user.update({\n          where: { id: verificationToken.userId },\n          data: { password: hashedPassword },\n        });\n\n        // Delete token\n        await this.prisma.verificationToken.delete({\n          where: { id: verificationToken.id },\n        });\n\n        res.json({ success: true, message: 'Password reset successfully' });\n      });\n    }\n\n    // OAuth routes\n    if (this.config.strategies?.google && typeof this.config.strategies.google === 'object') {\n      this.router.get('/google', this.oauth.authenticate('google'));\n      this.router.get('/google/callback',\n        this.oauth.authenticate('google', { session: false }),\n        this.handleOAuthCallback.bind(this)\n      );\n    }\n\n    if (this.config.strategies?.github && typeof this.config.strategies.github === 'object') {\n      this.router.get('/github', this.oauth.authenticate('github'));\n      this.router.get('/github/callback',\n        this.oauth.authenticate('github', { session: false }),\n        this.handleOAuthCallback.bind(this)\n      );\n    }\n  }\n\n  /**\n   * Handle OAuth callback\n   */\n  private async handleOAuthCallback(req: Request, res: Response): Promise<void> {\n    try {\n      const user = (req as any).user as User;\n      if (!user) {\n        res.status(401).json({ error: 'OAuth authentication failed' });\n        return;\n      }\n\n      // Generate tokens\n      const tokens = this.jwt.generateTokenPair(user);\n\n      // Create session\n      await this.createSession(user.id, tokens.refreshToken);\n\n      // Call hook\n      if (this.config.hooks?.onLogin) {\n        const session = await this.getSessionByRefreshToken(tokens.refreshToken);\n        await this.config.hooks.onLogin(user, session);\n      }\n\n      res.json({\n        success: true,\n        user,\n        accessToken: tokens.accessToken,\n        refreshToken: tokens.refreshToken,\n      });\n    } catch (error) {\n      res.status(500).json({ error: 'OAuth callback failed' });\n    }\n  }\n\n  // Static methods for schema generation\n  static generateSchema(provider: string) {\n    if (!SchemaGenerator.isValidProvider(provider)) {\n      throw new Error(`Unsupported database provider: ${provider}`);\n    }\n    return SchemaGenerator.generate(provider as any);\n  }\n\n  static generateEnv(provider: string) {\n    if (!SchemaGenerator.isValidProvider(provider)) {\n      throw new Error(`Unsupported database provider: ${provider}`);\n    }\n    return SchemaGenerator.generateEnvTemplate(provider as any);\n  }\n\n  static generateDockerCompose(provider: string) {\n    if (!SchemaGenerator.isValidProvider(provider)) {\n      throw new Error(`Unsupported database provider: ${provider}`);\n    }\n    return SchemaGenerator.generateDockerCompose(provider as any);\n  }\n\n  static getSupportedDatabases() {\n    return SchemaGenerator.getSupportedProviders();\n  }\n}\n\n// Export utilities\nexport { SchemaGenerator };\n","import jwt from 'jsonwebtoken';\nimport { User, JWTConfig } from '../types';\n\nexport class JWTService {\n  private config: Required<Pick<JWTConfig, 'secret' | 'accessTokenExpiry' | 'refreshTokenExpiry' | 'algorithm'>>;\n\n  constructor(config: JWTConfig) {\n    this.config = {\n      secret: config.secret || '',\n      accessTokenExpiry: config.accessTokenExpiry || '15m',\n      refreshTokenExpiry: config.refreshTokenExpiry || '7d',\n      algorithm: config.algorithm || 'HS256',\n    };\n  }\n\n  /**\n   * Generate access token\n   */\n  generateAccessToken(payload: { userId: string; email?: string; role?: string }): string {\n    return jwt.sign(payload, this.config.secret, {\n      expiresIn: this.config.accessTokenExpiry,\n      algorithm: this.config.algorithm as jwt.Algorithm,\n    } as any);\n  }\n\n  /**\n   * Generate refresh token\n   */\n  generateRefreshToken(payload: { userId: string; tokenId: string }): string {\n    return jwt.sign(payload, this.config.secret, {\n      expiresIn: this.config.refreshTokenExpiry,\n      algorithm: this.config.algorithm as jwt.Algorithm,\n    } as any);\n  }\n\n  /**\n   * Verify access token\n   */\n  verifyAccessToken(token: string): { userId: string; email?: string; role?: string } | null {\n    try {\n      const decoded = jwt.verify(token, this.config.secret, {\n        algorithms: [this.config.algorithm as jwt.Algorithm],\n      }) as any;\n      return {\n        userId: decoded.userId,\n        email: decoded.email,\n        role: decoded.role,\n      };\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Verify refresh token\n   */\n  verifyRefreshToken(token: string): { userId: string; tokenId: string } | null {\n    try {\n      const decoded = jwt.verify(token, this.config.secret, {\n        algorithms: [this.config.algorithm as jwt.Algorithm],\n      }) as any;\n      return {\n        userId: decoded.userId,\n        tokenId: decoded.tokenId,\n      };\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Decode token without verification (for debugging)\n   */\n  decodeToken(token: string): any {\n    try {\n      return jwt.decode(token);\n    } catch (error) {\n      return null;\n    }\n  }\n\n  /**\n   * Check if token is expired\n   */\n  isTokenExpired(token: string): boolean {\n    try {\n      const decoded = jwt.decode(token) as any;\n      if (!decoded || !decoded.exp) return true;\n      return Date.now() >= decoded.exp * 1000;\n    } catch (error) {\n      return true;\n    }\n  }\n\n  /**\n   * Generate token pair\n   */\n  generateTokenPair(user: User): {\n    accessToken: string;\n    refreshToken: string;\n    accessTokenExpiry: number;\n    refreshTokenExpiry: number;\n  } {\n    const tokenId = this.generateTokenId();\n    const accessToken = this.generateAccessToken({\n      userId: user.id,\n      email: user.email,\n      role: user.role,\n    });\n\n    const refreshToken = this.generateRefreshToken({\n      userId: user.id,\n      tokenId,\n    });\n\n    // Calculate expiry timestamps\n    const accessTokenExpiry = this.calculateExpiry(this.config.accessTokenExpiry!);\n    const refreshTokenExpiry = this.calculateExpiry(this.config.refreshTokenExpiry!);\n\n    return {\n      accessToken,\n      refreshToken,\n      accessTokenExpiry,\n      refreshTokenExpiry,\n    };\n  }\n\n  /**\n   * Generate unique token ID\n   */\n  private generateTokenId(): string {\n    return Date.now().toString(36) + Math.random().toString(36).substr(2);\n  }\n\n  /**\n   * Calculate expiry timestamp from string\n   */\n  private calculateExpiry(expiry: string): number {\n    // Simple implementation - in production you might want more robust parsing\n    const now = Date.now();\n    const match = expiry.match(/^(\\d+)([smhd])$/);\n    if (!match) return now + 15 * 60 * 1000; // Default 15 minutes\n\n    const value = parseInt(match[1]);\n    const unit = match[2];\n\n    switch (unit) {\n      case 's': return now + value * 1000;\n      case 'm': return now + value * 60 * 1000;\n      case 'h': return now + value * 60 * 60 * 1000;\n      case 'd': return now + value * 24 * 60 * 60 * 1000;\n      default: return now + 15 * 60 * 1000;\n    }\n  }\n\n  /**\n   * Refresh access token using refresh token\n   */\n  refreshAccessToken(refreshToken: string, user: User): string | null {\n    const decoded = this.verifyRefreshToken(refreshToken);\n    if (!decoded || decoded.userId !== user.id) {\n      return null;\n    }\n\n    return this.generateAccessToken({\n      userId: user.id,\n      email: user.email,\n      role: user.role,\n    });\n  }\n}\n","import bcrypt from 'bcrypt';\nimport { PasswordRequirements } from '../types';\n\nexport class PasswordService {\n  private bcryptRounds: number;\n\n  constructor(bcryptRounds: number = 12) {\n    this.bcryptRounds = bcryptRounds;\n  }\n\n  /**\n   * Hash a password\n   */\n  async hash(password: string): Promise<string> {\n    return bcrypt.hash(password, this.bcryptRounds);\n  }\n\n  /**\n   * Verify a password against its hash\n   */\n  async verify(password: string, hash: string): Promise<boolean> {\n    return bcrypt.compare(password, hash);\n  }\n\n  /**\n   * Validate password strength\n   */\n  validate(password: string, requirements?: PasswordRequirements): {\n    valid: boolean;\n    errors: string[];\n  } {\n    const errors: string[] = [];\n\n    // Default requirements\n    const reqs = {\n      uppercase: requirements?.uppercase ?? true,\n      lowercase: requirements?.lowercase ?? true,\n      numbers: requirements?.numbers ?? true,\n      symbols: requirements?.symbols ?? false,\n      minLength: 8,\n    };\n\n    // Check minimum length\n    if (password.length < reqs.minLength) {\n      errors.push(`Password must be at least ${reqs.minLength} characters long`);\n    }\n\n    // Check uppercase requirement\n    if (reqs.uppercase && !/[A-Z]/.test(password)) {\n      errors.push('Password must contain at least one uppercase letter');\n    }\n\n    // Check lowercase requirement\n    if (reqs.lowercase && !/[a-z]/.test(password)) {\n      errors.push('Password must contain at least one lowercase letter');\n    }\n\n    // Check numbers requirement\n    if (reqs.numbers && !/\\d/.test(password)) {\n      errors.push('Password must contain at least one number');\n    }\n\n    // Check symbols requirement\n    if (reqs.symbols && !/[!@#$%^&*()_+\\-=[\\]{};\"\\\\|,.<>?]/.test(password)) {\n      errors.push('Password must contain at least one special character');\n    }\n\n    return {\n      valid: errors.length === 0,\n      errors,\n    };\n  }\n\n  /**\n   * Generate a secure random password\n   */\n  generateSecurePassword(length: number = 12): string {\n    const charset = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*';\n    let password = '';\n\n    // Ensure at least one of each required character type\n    password += 'ABCDEFGHIJKLMNOPQRSTUVWXYZ'[Math.floor(Math.random() * 26)]; // uppercase\n    password += 'abcdefghijklmnopqrstuvwxyz'[Math.floor(Math.random() * 26)]; // lowercase\n    password += '0123456789'[Math.floor(Math.random() * 10)]; // number\n    password += '!@#$%^&*'[Math.floor(Math.random() * 8)]; // symbol\n\n    // Fill the rest randomly\n    for (let i = password.length; i < length; i++) {\n      password += charset[Math.floor(Math.random() * charset.length)];\n    }\n\n    // Shuffle the password\n    return password.split('').sort(() => Math.random() - 0.5).join('');\n  }\n\n  /**\n   * Check if password needs rehashing (for migration purposes)\n   */\n  needsRehash(hash: string): boolean {\n    try {\n      const hashInfo = bcrypt.getRounds(hash);\n      return hashInfo < this.bcryptRounds;\n    } catch (error) {\n      // If we can't parse the hash, assume it needs rehashing\n      return true;\n    }\n  }\n\n  /**\n   * Rehash a password if needed\n   */\n  async rehashIfNeeded(password: string, currentHash: string): Promise<string> {\n    if (this.needsRehash(currentHash)) {\n      return this.hash(password);\n    }\n    return currentHash;\n  }\n\n  /**\n   * Get password strength score (0-4)\n   * 0: Very weak\n   * 1: Weak\n   * 2: Fair\n   * 3: Good\n   * 4: Strong\n   */\n  getStrengthScore(password: string): number {\n    let score = 0;\n\n    // Length check\n    if (password.length >= 8) score++;\n    if (password.length >= 12) score++;\n\n    // Character variety\n    if (/[A-Z]/.test(password)) score++;\n    if (/[a-z]/.test(password)) score++;\n    if (/\\d/.test(password)) score++;\n    if (/[!@#$%^&*()_+\\-=[\\]{};\"\\\\|,.<>?]/.test(password)) score++;\n\n    // Complexity bonus\n    if (password.length >= 16 && score >= 4) score++;\n\n    return Math.min(score, 4);\n  }\n\n  /**\n   * Get strength label\n   */\n  getStrengthLabel(password: string): string {\n    const score = this.getStrengthScore(password);\n    const labels = ['Very Weak', 'Weak', 'Fair', 'Good', 'Strong'];\n    return labels[score];\n  }\n}\n","import passport from 'passport';\nimport { Strategy as GoogleStrategy, Profile, VerifyCallback } from 'passport-google-oauth20';\nimport { Strategy as GitHubStrategy } from 'passport-github2';\nimport { PrismaClient } from '@prisma/client';\nimport { OAuthStrategyConfig, User } from '../types';\n\nexport class OAuthService {\n  private prisma: PrismaClient;\n\n  constructor(prisma: PrismaClient) {\n    this.prisma = prisma;\n    this.initializePassport();\n  }\n\n  private initializePassport(): void {\n    // Serialize user for session\n    passport.serializeUser((user: any, done: any) => {\n      done(null, user.id);\n    });\n\n    passport.deserializeUser(async (id: string, done) => {\n      try {\n        const user = await this.prisma.user.findUnique({\n          where: { id },\n        });\n        done(null, user);\n      } catch (error) {\n        done(error, null);\n      }\n    });\n  }\n\n  /**\n   * Configure Google OAuth strategy\n   */\n  configureGoogle(config: OAuthStrategyConfig): void {\n    if (!config.clientId || !config.clientSecret) {\n      throw new Error('Google OAuth clientId and clientSecret are required');\n    }\n\n    passport.use(\n      new GoogleStrategy(\n        {\n          clientID: config.clientId,\n          clientSecret: config.clientSecret,\n          callbackURL: config.callbackURL || '/api/auth/google/callback',\n          scope: config.scope || ['profile', 'email'],\n        },\n        async (accessToken: string, refreshToken: string, profile: Profile, done: VerifyCallback) => {\n          try {\n            const user = await this.handleOAuthCallback(\n              'google',\n              profile,\n              accessToken,\n              refreshToken\n            );\n            done(null, user);\n          } catch (error) {\n            done(error as Error, undefined);\n          }\n        }\n      )\n    );\n  }\n\n  /**\n   * Configure GitHub OAuth strategy\n   */\n  configureGitHub(config: OAuthStrategyConfig): void {\n    if (!config.clientId || !config.clientSecret) {\n      throw new Error('GitHub OAuth clientId and clientSecret are required');\n    }\n\n    passport.use(\n      new GitHubStrategy(\n        {\n          clientID: config.clientId,\n          clientSecret: config.clientSecret,\n          callbackURL: config.callbackURL || '/api/auth/github/callback',\n          scope: config.scope || ['user:email'],\n        },\n        async (accessToken: string, refreshToken: string, profile: any, done: (error: Error | null, user?: User) => void) => {\n          try {\n            const user = await this.handleOAuthCallback(\n              'github',\n              profile,\n              accessToken,\n              refreshToken\n            );\n            done(null, user);\n          } catch (error) {\n            done(error as Error, undefined);\n          }\n        }\n      )\n    );\n  }\n\n  /**\n   * Handle OAuth callback and create/update user\n   */\n  private async handleOAuthCallback(\n    provider: string,\n    profile: Profile | { [key: string]: any },\n    accessToken: string,\n    refreshToken?: string\n  ): Promise<User> {\n    const providerAccountId = profile.id;\n    const email = profile.emails?.[0]?.value;\n    const name = profile.displayName || profile.username;\n    const avatar = profile.photos?.[0]?.value;\n\n    // Check if account already exists\n    let account = await this.prisma.account.findUnique({\n      where: {\n        provider_providerAccountId: {\n          provider,\n          providerAccountId,\n        },\n      },\n      include: { user: true },\n    });\n\n    if (account) {\n      // Update account tokens and return existing user\n      await this.prisma.account.update({\n        where: { id: account.id },\n        data: {\n          access_token: accessToken,\n          refresh_token: refreshToken,\n          expires_at: this.calculateTokenExpiry(),\n        },\n      });\n\n      // Update user profile if needed\n      if (account.user.name !== name || account.user.avatar !== avatar) {\n        await this.prisma.user.update({\n          where: { id: account.user.id },\n          data: { name, avatar },\n        });\n      }\n\n      return account.user;\n    }\n\n    // Check if user with this email already exists\n    let user = email ? await this.prisma.user.findUnique({\n      where: { email },\n    }) : null;\n\n    if (user) {\n      // Link the account to existing user\n      await this.prisma.account.create({\n        data: {\n          userId: user.id,\n          type: 'oauth',\n          provider,\n          providerAccountId,\n          access_token: accessToken,\n          refresh_token: refreshToken,\n          expires_at: this.calculateTokenExpiry(),\n        },\n      });\n\n      // Update user profile\n      await this.prisma.user.update({\n        where: { id: user.id },\n        data: { name, avatar },\n      });\n\n      return user;\n    }\n\n    // Create new user\n    user = await this.prisma.user.create({\n      data: {\n        email,\n        name,\n        avatar,\n        accounts: {\n          create: {\n            type: 'oauth',\n            provider,\n            providerAccountId,\n            access_token: accessToken,\n            refresh_token: refreshToken,\n            expires_at: this.calculateTokenExpiry(),\n          },\n        },\n      },\n    });\n\n    return user;\n  }\n\n  /**\n   * Calculate token expiry (default 1 hour)\n   */\n  private calculateTokenExpiry(): number {\n    return Math.floor(Date.now() / 1000) + 3600; // 1 hour from now\n  }\n\n  /**\n   * Get OAuth redirect URLs\n   */\n  getOAuthUrls(baseUrl: string = ''): {\n    google: { login: string; callback: string };\n    github: { login: string; callback: string };\n  } {\n    return {\n      google: {\n        login: `${baseUrl}/api/auth/google`,\n        callback: `${baseUrl}/api/auth/google/callback`,\n      },\n      github: {\n        login: `${baseUrl}/api/auth/github`,\n        callback: `${baseUrl}/api/auth/github/callback`,\n      },\n    };\n  }\n\n  /**\n   * Middleware for OAuth authentication\n   */\n  authenticate(provider: string, options: { [key: string]: any } = {}) {\n    return passport.authenticate(provider, {\n      session: false,\n      ...options,\n    });\n  }\n\n  /**\n   * Get passport instance\n   */\n  getPassport(): typeof passport {\n    return passport;\n  }\n}\n","import nodemailer, { Transporter } from 'nodemailer';\nimport { EmailConfig, User } from '../types';\n\nexport class EmailService {\n  private config: EmailConfig;\n  private transporter: Transporter;\n\n  constructor(config: EmailConfig) {\n    this.config = config;\n    this.transporter = this.createTransporter();\n  }\n\n  /**\n   * Create email transporter\n   */\n  private createTransporter() {\n    if (this.config.provider === 'resend') {\n      return nodemailer.createTransport({\n        host: 'smtp.resend.com',\n        port: 587,\n        secure: false,\n        auth: {\n          user: 'resend',\n          pass: this.config.apiKey,\n        },\n      });\n    }\n\n    if (this.config.provider === 'nodemailer') {\n      // For custom SMTP configuration\n      return nodemailer.createTransport(this.config.apiKey as any);\n    }\n\n    // Default - throw error if no provider configured\n    throw new Error('Email provider not configured');\n  }\n\n  /**\n   * Send email verification\n   */\n  async sendEmailVerification(user: User, token: string, baseUrl: string = ''): Promise<boolean> {\n    try {\n      const verificationUrl = `${baseUrl}/api/auth/verify-email/${token}`;\n\n      const html = `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2>Welcome to ${process.env.APP_NAME || 'Our App'}!</h2>\n          <p>Please verify your email address to complete your registration.</p>\n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${verificationUrl}\"\n               style=\"background-color: #007bff; color: white; padding: 12px 24px;\n                      text-decoration: none; border-radius: 5px; display: inline-block;\">\n              Verify Email Address\n            </a>\n          </div>\n          <p>If the button doesn't work, copy and paste this link into your browser:</p>\n          <p style=\"word-break: break-all; color: #666;\">${verificationUrl}</p>\n          <p>This link will expire in 24 hours.</p>\n          <p>If you didn't create an account, please ignore this email.</p>\n        </div>\n      `;\n\n      const text = `\n        Welcome to ${process.env.APP_NAME || 'Our App'}!\n\n        Please verify your email address by clicking this link:\n        ${verificationUrl}\n\n        This link will expire in 24 hours.\n\n        If you didn't create an account, please ignore this email.\n      `;\n\n      await this.sendEmail({\n        to: user.email!,\n        subject: `Verify your email - ${process.env.APP_NAME || 'Our App'}`,\n        html,\n        text,\n      });\n\n      return true;\n    } catch (error) {\n      console.error('Failed to send email verification:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Send password reset email\n   */\n  async sendPasswordReset(user: User, token: string, baseUrl: string = ''): Promise<boolean> {\n    try {\n      const resetUrl = `${baseUrl}/api/auth/reset-password/${token}`;\n\n      const html = `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2>Reset Your Password</h2>\n          <p>We received a request to reset your password. Click the button below to create a new password.</p>\n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${resetUrl}\"\n               style=\"background-color: #dc3545; color: white; padding: 12px 24px;\n                      text-decoration: none; border-radius: 5px; display: inline-block;\">\n              Reset Password\n            </a>\n          </div>\n          <p>If the button doesn't work, copy and paste this link into your browser:</p>\n          <p style=\"word-break: break-all; color: #666;\">${resetUrl}</p>\n          <p>This link will expire in 1 hour.</p>\n          <p>If you didn't request a password reset, please ignore this email.</p>\n        </div>\n      `;\n\n      const text = `\n        Reset Your Password\n\n        We received a request to reset your password. Click this link to create a new password:\n        ${resetUrl}\n\n        This link will expire in 1 hour.\n\n        If you didn't request a password reset, please ignore this email.\n      `;\n\n      await this.sendEmail({\n        to: user.email!,\n        subject: `Reset your password - ${process.env.APP_NAME || 'Our App'}`,\n        html,\n        text,\n      });\n\n      return true;\n    } catch (error) {\n      console.error('Failed to send password reset email:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Send magic link email\n   */\n  async sendMagicLink(user: User, token: string, baseUrl: string = ''): Promise<boolean> {\n    try {\n      const loginUrl = `${baseUrl}/api/auth/magic-link/verify/${token}`;\n\n      const html = `\n        <div style=\"font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto;\">\n          <h2>Sign In to ${process.env.APP_NAME || 'Our App'}</h2>\n          <p>Click the link below to sign in to your account.</p>\n          <div style=\"text-align: center; margin: 30px 0;\">\n            <a href=\"${loginUrl}\"\n               style=\"background-color: #28a745; color: white; padding: 12px 24px;\n                      text-decoration: none; border-radius: 5px; display: inline-block;\">\n              Sign In\n            </a>\n          </div>\n          <p>If the button doesn't work, copy and paste this link into your browser:</p>\n          <p style=\"word-break: break-all; color: #666;\">${loginUrl}</p>\n          <p>This link will expire in 15 minutes.</p>\n          <p>If you didn't request this sign-in link, please ignore this email.</p>\n        </div>\n      `;\n\n      const text = `\n        Sign In to ${process.env.APP_NAME || 'Our App'}\n\n        Click this link to sign in to your account:\n        ${loginUrl}\n\n        This link will expire in 15 minutes.\n\n        If you didn't request this sign-in link, please ignore this email.\n      `;\n\n      await this.sendEmail({\n        to: user.email!,\n        subject: `Sign in to ${process.env.APP_NAME || 'Our App'}`,\n        html,\n        text,\n      });\n\n      return true;\n    } catch (error) {\n      console.error('Failed to send magic link email:', error);\n      return false;\n    }\n  }\n\n  /**\n   * Send generic email\n   */\n  private async sendEmail(options: {\n    to: string;\n    subject: string;\n    html: string;\n    text: string;\n  }): Promise<void> {\n    await this.transporter.sendMail({\n      from: this.config.from || 'noreply@yourapp.com',\n      to: options.to,\n      subject: options.subject,\n      html: options.html,\n      text: options.text,\n    });\n  }\n\n  /**\n   * Generate verification token\n   */\n  static generateToken(): string {\n    return Math.random().toString(36).substring(2) + Date.now().toString(36);\n  }\n\n  /**\n   * Validate email format\n   */\n  static isValidEmail(email: string): boolean {\n    const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n    return emailRegex.test(email);\n  }\n}\n","import { DatabaseProvider } from '../types';\n\nexport class SchemaGenerator {\n  /**\n   * Generate complete Prisma schema for authentication\n   */\n  static generate(provider: DatabaseProvider): string {\n    const datasourceConfig = this.getDatasourceConfig(provider);\n\n    return `// This file was generated by AuthKit\n// Do not edit manually - regenerate using: npx authkit generate-schema\n\n${datasourceConfig}\n\nmodel User {\n  id            String    @id @default(cuid())\n  email         String?   @unique\n  emailVerified Boolean   @default(false)\n  phone         String?   @unique\n  phoneVerified Boolean   @default(false)\n  password      String?\n\n  // Profile\n  name          String?\n  avatar        String?\n  role          Role      @default(USER)\n\n  // Security\n  twoFactorEnabled Boolean @default(false)\n  twoFactorSecret  String?\n\n  // Metadata\n  createdAt     DateTime  @default(now())\n  updatedAt     DateTime  @updatedAt\n  lastLoginAt   DateTime?\n\n  // Relations\n  accounts      Account[]\n  sessions      Session[]\n  verificationTokens VerificationToken[]\n\n  @@index([email])\n  @@index([phone])\n  @@map(\"users\")\n}\n\nmodel Account {\n  id                String  @id @default(cuid())\n  userId            String\n  type              String  // oauth, email\n  provider          String  // google, github, credentials\n  providerAccountId String\n  refresh_token     String?\n  access_token      String?\n  expires_at        Int?\n  token_type        String?\n  scope             String?\n  id_token          String?\n  session_state     String?\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@unique([provider, providerAccountId])\n  @@index([userId])\n  @@map(\"accounts\")\n}\n\nmodel Session {\n  id           String   @id @default(cuid())\n  userId       String\n  refreshToken String   @unique\n  userAgent    String?\n  ipAddress    String?\n  expiresAt    DateTime\n  createdAt    DateTime @default(now())\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@index([userId])\n  @@index([refreshToken])\n  @@map(\"sessions\")\n}\n\nmodel VerificationToken {\n  id        String   @id @default(cuid())\n  userId    String\n  token     String   @unique\n  type      TokenType\n  expiresAt DateTime\n  createdAt DateTime @default(now())\n\n  user User @relation(fields: [userId], references: [id], onDelete: Cascade)\n\n  @@index([token])\n  @@index([userId])\n  @@map(\"verification_tokens\")\n}\n\nenum Role {\n  USER\n  ADMIN\n  MODERATOR\n  @@map(\"roles\")\n}\n\nenum TokenType {\n  EMAIL_VERIFICATION\n  PASSWORD_RESET\n  PHONE_VERIFICATION\n  TWO_FACTOR\n  MAGIC_LINK\n  @@map(\"token_types\")\n}`;\n  }\n\n  /**\n   * Get datasource configuration for different providers\n   */\n  private static getDatasourceConfig(provider: DatabaseProvider): string {\n    const configs = {\n      postgresql: `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"postgresql\"\n  url      = env(\"DATABASE_URL\")\n}`,\n      mysql: `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"mysql\"\n  url      = env(\"DATABASE_URL\")\n}`,\n      sqlite: `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"sqlite\"\n  url      = env(\"DATABASE_URL\")\n}`,\n      sqlserver: `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"sqlserver\"\n  url      = env(\"DATABASE_URL\")\n}`,\n      mongodb: `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"mongodb\"\n  url      = env(\"DATABASE_URL\")\n}`,\n      cockroachdb: `generator client {\n  provider = \"prisma-client-js\"\n}\n\ndatasource db {\n  provider = \"cockroachdb\"\n  url      = env(\"DATABASE_URL\")\n}`\n    };\n\n    return configs[provider] || configs.postgresql;\n  }\n\n  /**\n   * Generate environment variables template\n   */\n  static generateEnvTemplate(provider: DatabaseProvider): string {\n    const dbUrls = {\n      postgresql: 'postgresql://username:password@localhost:5432/authkit_db?schema=public',\n      mysql: 'mysql://username:password@localhost:3306/authkit_db',\n      sqlite: './dev.db',\n      sqlserver: 'sqlserver://localhost:1433;database=authkit_db;user=username;password=password',\n      mongodb: 'mongodb://localhost:27017/authkit_db',\n      cockroachdb: 'postgresql://username:password@localhost:26257/authkit_db?schema=public'\n    };\n\n    return `# Database\nDATABASE_URL=\"${dbUrls[provider]}\"\n\n# JWT\nJWT_SECRET=\"your-super-secret-jwt-key-min-32-chars\"\n\n# OAuth Providers (optional)\nGOOGLE_CLIENT_ID=\"\"\nGOOGLE_CLIENT_SECRET=\"\"\nGITHUB_CLIENT_ID=\"\"\nGITHUB_CLIENT_SECRET=\"\"\n\n# Email Provider (optional)\nRESEND_API_KEY=\"\"\nEMAIL_FROM=\"noreply@yourapp.com\"\n\n# Phone/SMS Provider (optional)\nTWILIO_ACCOUNT_SID=\"\"\nTWILIO_AUTH_TOKEN=\"\"\nTWILIO_PHONE_NUMBER=\"\"\n\n# App Configuration\nNODE_ENV=\"development\"\nAPP_URL=\"http://localhost:3000\"`;\n  }\n\n  /**\n   * Generate Docker Compose configuration\n   */\n  static generateDockerCompose(provider: DatabaseProvider): string {\n    const services: Record<DatabaseProvider, string> = {\n      postgresql: `version: '3.8'\nservices:\n  db:\n    image: postgres:15\n    restart: always\n    environment:\n      POSTGRES_USER: postgres\n      POSTGRES_PASSWORD: password\n      POSTGRES_DB: authkit_db\n    ports:\n      - \"5432:5432\"\n    volumes:\n      - postgres_data:/var/lib/postgresql/data\n\nvolumes:\n  postgres_data:`,\n\n      mysql: `version: '3.8'\nservices:\n  db:\n    image: mysql:8\n    restart: always\n    environment:\n      MYSQL_ROOT_PASSWORD: password\n      MYSQL_DATABASE: authkit_db\n      MYSQL_USER: user\n      MYSQL_PASSWORD: password\n    ports:\n      - \"3306:3306\"\n    volumes:\n      - mysql_data:/var/lib/mysql\n\nvolumes:\n  mysql_data:`,\n\n      sqlite: `# SQLite doesn't need Docker Compose\n# Database file will be created automatically`,\n\n      sqlserver: `version: '3.8'\nservices:\n  db:\n    image: mcr.microsoft.com/mssql/server:2022-latest\n    restart: always\n    environment:\n      ACCEPT_EULA: Y\n      SA_PASSWORD: StrongPassword123!\n      MSSQL_DB: authkit_db\n    ports:\n      - \"1433:1433\"\n    volumes:\n      - sqlserver_data:/var/opt/mssql\n\nvolumes:\n  sqlserver_data:`,\n\n      mongodb: `version: '3.8'\nservices:\n  db:\n    image: mongo:7\n    restart: always\n    environment:\n      MONGO_INITDB_ROOT_USERNAME: admin\n      MONGO_INITDB_ROOT_PASSWORD: password\n      MONGO_INITDB_DATABASE: authkit_db\n    ports:\n      - \"27017:27017\"\n    volumes:\n      - mongo_data:/data/db\n\nvolumes:\n  mongo_data:`,\n\n      cockroachdb: `version: '3.8'\nservices:\n  db:\n    image: cockroachdb/cockroach:v23.1.0\n    restart: always\n    command: start-single-node --insecure --listen-addr=0.0.0.0:26257 --http-addr=0.0.0.0:8080\n    ports:\n      - \"26257:26257\"\n      - \"8080:8080\"\n    volumes:\n      - cockroach_data:/cockroach/cockroach-data\n\nvolumes:\n  cockroach_data:`\n    };\n\n    return services[provider];\n  }\n\n  /**\n   * List all supported providers\n   */\n  static getSupportedProviders(): DatabaseProvider[] {\n    return ['postgresql', 'mysql', 'sqlite', 'sqlserver', 'mongodb', 'cockroachdb'];\n  }\n\n  /**\n   * Validate provider\n   */\n  static isValidProvider(provider: string): provider is DatabaseProvider {\n    return this.getSupportedProviders().includes(provider as DatabaseProvider);\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAAwD;AAExD,gCAAsB;;;ACFtB,0BAAgB;AAGT,IAAM,aAAN,MAAiB;AAAA,EACd;AAAA,EAER,YAAY,QAAmB;AAC7B,SAAK,SAAS;AAAA,MACZ,QAAQ,OAAO,UAAU;AAAA,MACzB,mBAAmB,OAAO,qBAAqB;AAAA,MAC/C,oBAAoB,OAAO,sBAAsB;AAAA,MACjD,WAAW,OAAO,aAAa;AAAA,IACjC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,oBAAoB,SAAoE;AACtF,WAAO,oBAAAA,QAAI,KAAK,SAAS,KAAK,OAAO,QAAQ;AAAA,MAC3C,WAAW,KAAK,OAAO;AAAA,MACvB,WAAW,KAAK,OAAO;AAAA,IACzB,CAAQ;AAAA,EACV;AAAA;AAAA;AAAA;AAAA,EAKA,qBAAqB,SAAsD;AACzE,WAAO,oBAAAA,QAAI,KAAK,SAAS,KAAK,OAAO,QAAQ;AAAA,MAC3C,WAAW,KAAK,OAAO;AAAA,MACvB,WAAW,KAAK,OAAO;AAAA,IACzB,CAAQ;AAAA,EACV;AAAA;AAAA;AAAA;AAAA,EAKA,kBAAkB,OAAyE;AACzF,QAAI;AACF,YAAM,UAAU,oBAAAA,QAAI,OAAO,OAAO,KAAK,OAAO,QAAQ;AAAA,QACpD,YAAY,CAAC,KAAK,OAAO,SAA0B;AAAA,MACrD,CAAC;AACD,aAAO;AAAA,QACL,QAAQ,QAAQ;AAAA,QAChB,OAAO,QAAQ;AAAA,QACf,MAAM,QAAQ;AAAA,MAChB;AAAA,IACF,SAAS,OAAO;AACd,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,mBAAmB,OAA2D;AAC5E,QAAI;AACF,YAAM,UAAU,oBAAAA,QAAI,OAAO,OAAO,KAAK,OAAO,QAAQ;AAAA,QACpD,YAAY,CAAC,KAAK,OAAO,SAA0B;AAAA,MACrD,CAAC;AACD,aAAO;AAAA,QACL,QAAQ,QAAQ;AAAA,QAChB,SAAS,QAAQ;AAAA,MACnB;AAAA,IACF,SAAS,OAAO;AACd,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,OAAoB;AAC9B,QAAI;AACF,aAAO,oBAAAA,QAAI,OAAO,KAAK;AAAA,IACzB,SAAS,OAAO;AACd,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,eAAe,OAAwB;AACrC,QAAI;AACF,YAAM,UAAU,oBAAAA,QAAI,OAAO,KAAK;AAChC,UAAI,CAAC,WAAW,CAAC,QAAQ,IAAK,QAAO;AACrC,aAAO,KAAK,IAAI,KAAK,QAAQ,MAAM;AAAA,IACrC,SAAS,OAAO;AACd,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,kBAAkB,MAKhB;AACA,UAAM,UAAU,KAAK,gBAAgB;AACrC,UAAM,cAAc,KAAK,oBAAoB;AAAA,MAC3C,QAAQ,KAAK;AAAA,MACb,OAAO,KAAK;AAAA,MACZ,MAAM,KAAK;AAAA,IACb,CAAC;AAED,UAAM,eAAe,KAAK,qBAAqB;AAAA,MAC7C,QAAQ,KAAK;AAAA,MACb;AAAA,IACF,CAAC;AAGD,UAAM,oBAAoB,KAAK,gBAAgB,KAAK,OAAO,iBAAkB;AAC7E,UAAM,qBAAqB,KAAK,gBAAgB,KAAK,OAAO,kBAAmB;AAE/E,WAAO;AAAA,MACL;AAAA,MACA;AAAA,MACA;AAAA,MACA;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,kBAA0B;AAChC,WAAO,KAAK,IAAI,EAAE,SAAS,EAAE,IAAI,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,OAAO,CAAC;AAAA,EACtE;AAAA;AAAA;AAAA;AAAA,EAKQ,gBAAgB,QAAwB;AAE9C,UAAM,MAAM,KAAK,IAAI;AACrB,UAAM,QAAQ,OAAO,MAAM,iBAAiB;AAC5C,QAAI,CAAC,MAAO,QAAO,MAAM,KAAK,KAAK;AAEnC,UAAM,QAAQ,SAAS,MAAM,CAAC,CAAC;AAC/B,UAAM,OAAO,MAAM,CAAC;AAEpB,YAAQ,MAAM;AAAA,MACZ,KAAK;AAAK,eAAO,MAAM,QAAQ;AAAA,MAC/B,KAAK;AAAK,eAAO,MAAM,QAAQ,KAAK;AAAA,MACpC,KAAK;AAAK,eAAO,MAAM,QAAQ,KAAK,KAAK;AAAA,MACzC,KAAK;AAAK,eAAO,MAAM,QAAQ,KAAK,KAAK,KAAK;AAAA,MAC9C;AAAS,eAAO,MAAM,KAAK,KAAK;AAAA,IAClC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,mBAAmB,cAAsB,MAA2B;AAClE,UAAM,UAAU,KAAK,mBAAmB,YAAY;AACpD,QAAI,CAAC,WAAW,QAAQ,WAAW,KAAK,IAAI;AAC1C,aAAO;AAAA,IACT;AAEA,WAAO,KAAK,oBAAoB;AAAA,MAC9B,QAAQ,KAAK;AAAA,MACb,OAAO,KAAK;AAAA,MACZ,MAAM,KAAK;AAAA,IACb,CAAC;AAAA,EACH;AACF;;;AC1KA,oBAAmB;AAGZ,IAAM,kBAAN,MAAsB;AAAA,EACnB;AAAA,EAER,YAAY,eAAuB,IAAI;AACrC,SAAK,eAAe;AAAA,EACtB;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,KAAK,UAAmC;AAC5C,WAAO,cAAAC,QAAO,KAAK,UAAU,KAAK,YAAY;AAAA,EAChD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,UAAkB,MAAgC;AAC7D,WAAO,cAAAA,QAAO,QAAQ,UAAU,IAAI;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,SAAS,UAAkB,cAGzB;AACA,UAAM,SAAmB,CAAC;AAG1B,UAAM,OAAO;AAAA,MACX,WAAW,cAAc,aAAa;AAAA,MACtC,WAAW,cAAc,aAAa;AAAA,MACtC,SAAS,cAAc,WAAW;AAAA,MAClC,SAAS,cAAc,WAAW;AAAA,MAClC,WAAW;AAAA,IACb;AAGA,QAAI,SAAS,SAAS,KAAK,WAAW;AACpC,aAAO,KAAK,6BAA6B,KAAK,SAAS,kBAAkB;AAAA,IAC3E;AAGA,QAAI,KAAK,aAAa,CAAC,QAAQ,KAAK,QAAQ,GAAG;AAC7C,aAAO,KAAK,qDAAqD;AAAA,IACnE;AAGA,QAAI,KAAK,aAAa,CAAC,QAAQ,KAAK,QAAQ,GAAG;AAC7C,aAAO,KAAK,qDAAqD;AAAA,IACnE;AAGA,QAAI,KAAK,WAAW,CAAC,KAAK,KAAK,QAAQ,GAAG;AACxC,aAAO,KAAK,2CAA2C;AAAA,IACzD;AAGA,QAAI,KAAK,WAAW,CAAC,mCAAmC,KAAK,QAAQ,GAAG;AACtE,aAAO,KAAK,sDAAsD;AAAA,IACpE;AAEA,WAAO;AAAA,MACL,OAAO,OAAO,WAAW;AAAA,MACzB;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,uBAAuB,SAAiB,IAAY;AAClD,UAAM,UAAU;AAChB,QAAI,WAAW;AAGf,gBAAY,6BAA6B,KAAK,MAAM,KAAK,OAAO,IAAI,EAAE,CAAC;AACvE,gBAAY,6BAA6B,KAAK,MAAM,KAAK,OAAO,IAAI,EAAE,CAAC;AACvE,gBAAY,aAAa,KAAK,MAAM,KAAK,OAAO,IAAI,EAAE,CAAC;AACvD,gBAAY,WAAW,KAAK,MAAM,KAAK,OAAO,IAAI,CAAC,CAAC;AAGpD,aAAS,IAAI,SAAS,QAAQ,IAAI,QAAQ,KAAK;AAC7C,kBAAY,QAAQ,KAAK,MAAM,KAAK,OAAO,IAAI,QAAQ,MAAM,CAAC;AAAA,IAChE;AAGA,WAAO,SAAS,MAAM,EAAE,EAAE,KAAK,MAAM,KAAK,OAAO,IAAI,GAAG,EAAE,KAAK,EAAE;AAAA,EACnE;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,MAAuB;AACjC,QAAI;AACF,YAAM,WAAW,cAAAA,QAAO,UAAU,IAAI;AACtC,aAAO,WAAW,KAAK;AAAA,IACzB,SAAS,OAAO;AAEd,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,eAAe,UAAkB,aAAsC;AAC3E,QAAI,KAAK,YAAY,WAAW,GAAG;AACjC,aAAO,KAAK,KAAK,QAAQ;AAAA,IAC3B;AACA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAUA,iBAAiB,UAA0B;AACzC,QAAI,QAAQ;AAGZ,QAAI,SAAS,UAAU,EAAG;AAC1B,QAAI,SAAS,UAAU,GAAI;AAG3B,QAAI,QAAQ,KAAK,QAAQ,EAAG;AAC5B,QAAI,QAAQ,KAAK,QAAQ,EAAG;AAC5B,QAAI,KAAK,KAAK,QAAQ,EAAG;AACzB,QAAI,mCAAmC,KAAK,QAAQ,EAAG;AAGvD,QAAI,SAAS,UAAU,MAAM,SAAS,EAAG;AAEzC,WAAO,KAAK,IAAI,OAAO,CAAC;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA,EAKA,iBAAiB,UAA0B;AACzC,UAAM,QAAQ,KAAK,iBAAiB,QAAQ;AAC5C,UAAM,SAAS,CAAC,aAAa,QAAQ,QAAQ,QAAQ,QAAQ;AAC7D,WAAO,OAAO,KAAK;AAAA,EACrB;AACF;;;ACzJA,sBAAqB;AACrB,qCAAoE;AACpE,8BAA2C;AAIpC,IAAM,eAAN,MAAmB;AAAA,EAChB;AAAA,EAER,YAAY,QAAsB;AAChC,SAAK,SAAS;AACd,SAAK,mBAAmB;AAAA,EAC1B;AAAA,EAEQ,qBAA2B;AAEjC,oBAAAC,QAAS,cAAc,CAAC,MAAW,SAAc;AAC/C,WAAK,MAAM,KAAK,EAAE;AAAA,IACpB,CAAC;AAED,oBAAAA,QAAS,gBAAgB,OAAO,IAAY,SAAS;AACnD,UAAI;AACF,cAAM,OAAO,MAAM,KAAK,OAAO,KAAK,WAAW;AAAA,UAC7C,OAAO,EAAE,GAAG;AAAA,QACd,CAAC;AACD,aAAK,MAAM,IAAI;AAAA,MACjB,SAAS,OAAO;AACd,aAAK,OAAO,IAAI;AAAA,MAClB;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,QAAmC;AACjD,QAAI,CAAC,OAAO,YAAY,CAAC,OAAO,cAAc;AAC5C,YAAM,IAAI,MAAM,qDAAqD;AAAA,IACvE;AAEA,oBAAAA,QAAS;AAAA,MACP,IAAI,+BAAAC;AAAA,QACF;AAAA,UACE,UAAU,OAAO;AAAA,UACjB,cAAc,OAAO;AAAA,UACrB,aAAa,OAAO,eAAe;AAAA,UACnC,OAAO,OAAO,SAAS,CAAC,WAAW,OAAO;AAAA,QAC5C;AAAA,QACA,OAAO,aAAqB,cAAsB,SAAkB,SAAyB;AAC3F,cAAI;AACF,kBAAM,OAAO,MAAM,KAAK;AAAA,cACtB;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,YACF;AACA,iBAAK,MAAM,IAAI;AAAA,UACjB,SAAS,OAAO;AACd,iBAAK,OAAgB,MAAS;AAAA,UAChC;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,gBAAgB,QAAmC;AACjD,QAAI,CAAC,OAAO,YAAY,CAAC,OAAO,cAAc;AAC5C,YAAM,IAAI,MAAM,qDAAqD;AAAA,IACvE;AAEA,oBAAAD,QAAS;AAAA,MACP,IAAI,wBAAAE;AAAA,QACF;AAAA,UACE,UAAU,OAAO;AAAA,UACjB,cAAc,OAAO;AAAA,UACrB,aAAa,OAAO,eAAe;AAAA,UACnC,OAAO,OAAO,SAAS,CAAC,YAAY;AAAA,QACtC;AAAA,QACA,OAAO,aAAqB,cAAsB,SAAc,SAAqD;AACnH,cAAI;AACF,kBAAM,OAAO,MAAM,KAAK;AAAA,cACtB;AAAA,cACA;AAAA,cACA;AAAA,cACA;AAAA,YACF;AACA,iBAAK,MAAM,IAAI;AAAA,UACjB,SAAS,OAAO;AACd,iBAAK,OAAgB,MAAS;AAAA,UAChC;AAAA,QACF;AAAA,MACF;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,oBACZ,UACA,SACA,aACA,cACe;AACf,UAAM,oBAAoB,QAAQ;AAClC,UAAM,QAAQ,QAAQ,SAAS,CAAC,GAAG;AACnC,UAAM,OAAO,QAAQ,eAAe,QAAQ;AAC5C,UAAM,SAAS,QAAQ,SAAS,CAAC,GAAG;AAGpC,QAAI,UAAU,MAAM,KAAK,OAAO,QAAQ,WAAW;AAAA,MACjD,OAAO;AAAA,QACL,4BAA4B;AAAA,UAC1B;AAAA,UACA;AAAA,QACF;AAAA,MACF;AAAA,MACA,SAAS,EAAE,MAAM,KAAK;AAAA,IACxB,CAAC;AAED,QAAI,SAAS;AAEX,YAAM,KAAK,OAAO,QAAQ,OAAO;AAAA,QAC/B,OAAO,EAAE,IAAI,QAAQ,GAAG;AAAA,QACxB,MAAM;AAAA,UACJ,cAAc;AAAA,UACd,eAAe;AAAA,UACf,YAAY,KAAK,qBAAqB;AAAA,QACxC;AAAA,MACF,CAAC;AAGD,UAAI,QAAQ,KAAK,SAAS,QAAQ,QAAQ,KAAK,WAAW,QAAQ;AAChE,cAAM,KAAK,OAAO,KAAK,OAAO;AAAA,UAC5B,OAAO,EAAE,IAAI,QAAQ,KAAK,GAAG;AAAA,UAC7B,MAAM,EAAE,MAAM,OAAO;AAAA,QACvB,CAAC;AAAA,MACH;AAEA,aAAO,QAAQ;AAAA,IACjB;AAGA,QAAI,OAAO,QAAQ,MAAM,KAAK,OAAO,KAAK,WAAW;AAAA,MACnD,OAAO,EAAE,MAAM;AAAA,IACjB,CAAC,IAAI;AAEL,QAAI,MAAM;AAER,YAAM,KAAK,OAAO,QAAQ,OAAO;AAAA,QAC/B,MAAM;AAAA,UACJ,QAAQ,KAAK;AAAA,UACb,MAAM;AAAA,UACN;AAAA,UACA;AAAA,UACA,cAAc;AAAA,UACd,eAAe;AAAA,UACf,YAAY,KAAK,qBAAqB;AAAA,QACxC;AAAA,MACF,CAAC;AAGD,YAAM,KAAK,OAAO,KAAK,OAAO;AAAA,QAC5B,OAAO,EAAE,IAAI,KAAK,GAAG;AAAA,QACrB,MAAM,EAAE,MAAM,OAAO;AAAA,MACvB,CAAC;AAED,aAAO;AAAA,IACT;AAGA,WAAO,MAAM,KAAK,OAAO,KAAK,OAAO;AAAA,MACnC,MAAM;AAAA,QACJ;AAAA,QACA;AAAA,QACA;AAAA,QACA,UAAU;AAAA,UACR,QAAQ;AAAA,YACN,MAAM;AAAA,YACN;AAAA,YACA;AAAA,YACA,cAAc;AAAA,YACd,eAAe;AAAA,YACf,YAAY,KAAK,qBAAqB;AAAA,UACxC;AAAA,QACF;AAAA,MACF;AAAA,IACF,CAAC;AAED,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKQ,uBAA+B;AACrC,WAAO,KAAK,MAAM,KAAK,IAAI,IAAI,GAAI,IAAI;AAAA,EACzC;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,UAAkB,IAG7B;AACA,WAAO;AAAA,MACL,QAAQ;AAAA,QACN,OAAO,GAAG,OAAO;AAAA,QACjB,UAAU,GAAG,OAAO;AAAA,MACtB;AAAA,MACA,QAAQ;AAAA,QACN,OAAO,GAAG,OAAO;AAAA,QACjB,UAAU,GAAG,OAAO;AAAA,MACtB;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,aAAa,UAAkB,UAAkC,CAAC,GAAG;AACnE,WAAO,gBAAAF,QAAS,aAAa,UAAU;AAAA,MACrC,SAAS;AAAA,MACT,GAAG;AAAA,IACL,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,cAA+B;AAC7B,WAAO,gBAAAA;AAAA,EACT;AACF;;;AC7OA,wBAAwC;AAGjC,IAAM,eAAN,MAAmB;AAAA,EAChB;AAAA,EACA;AAAA,EAER,YAAY,QAAqB;AAC/B,SAAK,SAAS;AACd,SAAK,cAAc,KAAK,kBAAkB;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKQ,oBAAoB;AAC1B,QAAI,KAAK,OAAO,aAAa,UAAU;AACrC,aAAO,kBAAAG,QAAW,gBAAgB;AAAA,QAChC,MAAM;AAAA,QACN,MAAM;AAAA,QACN,QAAQ;AAAA,QACR,MAAM;AAAA,UACJ,MAAM;AAAA,UACN,MAAM,KAAK,OAAO;AAAA,QACpB;AAAA,MACF,CAAC;AAAA,IACH;AAEA,QAAI,KAAK,OAAO,aAAa,cAAc;AAEzC,aAAO,kBAAAA,QAAW,gBAAgB,KAAK,OAAO,MAAa;AAAA,IAC7D;AAGA,UAAM,IAAI,MAAM,+BAA+B;AAAA,EACjD;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,sBAAsB,MAAY,OAAe,UAAkB,IAAsB;AAC7F,QAAI;AACF,YAAM,kBAAkB,GAAG,OAAO,0BAA0B,KAAK;AAEjE,YAAM,OAAO;AAAA;AAAA,2BAEQ,QAAQ,IAAI,YAAY,SAAS;AAAA;AAAA;AAAA,uBAGrC,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2DAOqB,eAAe;AAAA;AAAA;AAAA;AAAA;AAMpE,YAAM,OAAO;AAAA,qBACE,QAAQ,IAAI,YAAY,SAAS;AAAA;AAAA;AAAA,UAG5C,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAOnB,YAAM,KAAK,UAAU;AAAA,QACnB,IAAI,KAAK;AAAA,QACT,SAAS,uBAAuB,QAAQ,IAAI,YAAY,SAAS;AAAA,QACjE;AAAA,QACA;AAAA,MACF,CAAC;AAED,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,MAAM,sCAAsC,KAAK;AACzD,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,kBAAkB,MAAY,OAAe,UAAkB,IAAsB;AACzF,QAAI;AACF,YAAM,WAAW,GAAG,OAAO,4BAA4B,KAAK;AAE5D,YAAM,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA,uBAKI,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2DAO4B,QAAQ;AAAA;AAAA;AAAA;AAAA;AAM7D,YAAM,OAAO;AAAA;AAAA;AAAA;AAAA,UAIT,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAOZ,YAAM,KAAK,UAAU;AAAA,QACnB,IAAI,KAAK;AAAA,QACT,SAAS,yBAAyB,QAAQ,IAAI,YAAY,SAAS;AAAA,QACnE;AAAA,QACA;AAAA,MACF,CAAC;AAED,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,MAAM,wCAAwC,KAAK;AAC3D,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,cAAc,MAAY,OAAe,UAAkB,IAAsB;AACrF,QAAI;AACF,YAAM,WAAW,GAAG,OAAO,+BAA+B,KAAK;AAE/D,YAAM,OAAO;AAAA;AAAA,2BAEQ,QAAQ,IAAI,YAAY,SAAS;AAAA;AAAA;AAAA,uBAGrC,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,2DAO4B,QAAQ;AAAA;AAAA;AAAA;AAAA;AAM7D,YAAM,OAAO;AAAA,qBACE,QAAQ,IAAI,YAAY,SAAS;AAAA;AAAA;AAAA,UAG5C,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAOZ,YAAM,KAAK,UAAU;AAAA,QACnB,IAAI,KAAK;AAAA,QACT,SAAS,cAAc,QAAQ,IAAI,YAAY,SAAS;AAAA,QACxD;AAAA,QACA;AAAA,MACF,CAAC;AAED,aAAO;AAAA,IACT,SAAS,OAAO;AACd,cAAQ,MAAM,oCAAoC,KAAK;AACvD,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,UAAU,SAKN;AAChB,UAAM,KAAK,YAAY,SAAS;AAAA,MAC9B,MAAM,KAAK,OAAO,QAAQ;AAAA,MAC1B,IAAI,QAAQ;AAAA,MACZ,SAAS,QAAQ;AAAA,MACjB,MAAM,QAAQ;AAAA,MACd,MAAM,QAAQ;AAAA,IAChB,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,gBAAwB;AAC7B,WAAO,KAAK,OAAO,EAAE,SAAS,EAAE,EAAE,UAAU,CAAC,IAAI,KAAK,IAAI,EAAE,SAAS,EAAE;AAAA,EACzE;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,aAAa,OAAwB;AAC1C,UAAM,aAAa;AACnB,WAAO,WAAW,KAAK,KAAK;AAAA,EAC9B;AACF;;;ACzNO,IAAM,kBAAN,MAAsB;AAAA;AAAA;AAAA;AAAA,EAI3B,OAAO,SAAS,UAAoC;AAClD,UAAM,mBAAmB,KAAK,oBAAoB,QAAQ;AAE1D,WAAO;AAAA;AAAA;AAAA,EAGT,gBAAgB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAqGhB;AAAA;AAAA;AAAA;AAAA,EAKA,OAAe,oBAAoB,UAAoC;AACrE,UAAM,UAAU;AAAA,MACd,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQZ,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQP,QAAQ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQR,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQX,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAQT,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAQf;AAEA,WAAO,QAAQ,QAAQ,KAAK,QAAQ;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,oBAAoB,UAAoC;AAC7D,UAAM,SAAS;AAAA,MACb,YAAY;AAAA,MACZ,OAAO;AAAA,MACP,QAAQ;AAAA,MACR,WAAW;AAAA,MACX,SAAS;AAAA,MACT,aAAa;AAAA,IACf;AAEA,WAAO;AAAA,gBACK,OAAO,QAAQ,CAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAuB9B;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,sBAAsB,UAAoC;AAC/D,UAAM,WAA6C;AAAA,MACjD,YAAY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAiBZ,OAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAkBP,QAAQ;AAAA;AAAA,MAGR,WAAW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAiBX,SAAS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAiBT,aAAa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAcf;AAEA,WAAO,SAAS,QAAQ;AAAA,EAC1B;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,wBAA4C;AACjD,WAAO,CAAC,cAAc,SAAS,UAAU,aAAa,WAAW,aAAa;AAAA,EAChF;AAAA;AAAA;AAAA;AAAA,EAKA,OAAO,gBAAgB,UAAgD;AACrE,WAAO,KAAK,sBAAsB,EAAE,SAAS,QAA4B;AAAA,EAC3E;AACF;;;ALvTO,IAAM,UAAN,MAAc;AAAA,EACX;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EACA;AAAA,EAER,YAAY,QAAoB;AAC9B,SAAK,SAAS,OAAO;AACrB,SAAK,SAAS;AAAA,MACZ,KAAK;AAAA,QACH,QAAQ,OAAO;AAAA,QACf,mBAAmB;AAAA,QACnB,oBAAoB;AAAA,QACpB,WAAW;AAAA,QACX,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,YAAY;AAAA,QACV,OAAO;AAAA,QACP,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,UAAU;AAAA,QACR,cAAc;AAAA,QACd,cAAc;AAAA,UACZ,SAAS;AAAA,UACT,aAAa;AAAA,UACb,UAAU,KAAK,KAAK;AAAA,QACtB;AAAA,QACA,eAAe,IAAI,KAAK,KAAK,KAAK;AAAA,QAClC,gBAAgB;AAAA,UACd,UAAU;AAAA,UACV,QAAQ;AAAA,UACR,UAAU;AAAA,QACZ;AAAA,QACA,GAAG,OAAO;AAAA,MACZ;AAAA,MACA,GAAG;AAAA,IACL;AAEA,SAAK,MAAM,IAAI,WAAW,KAAK,OAAO,GAAI;AAC1C,SAAK,WAAW,IAAI,gBAAgB,KAAK,OAAO,SAAU,YAAY;AACtE,SAAK,QAAQ,IAAI,aAAa,KAAK,MAAM;AAEzC,QAAI,KAAK,OAAO,OAAO;AACrB,WAAK,QAAQ,IAAI,aAAa,KAAK,OAAO,KAAK;AAAA,IACjD;AAEA,SAAK,aAAS,uBAAO;AAErB,SAAK,qBAAqB;AAC1B,SAAK,YAAY;AAAA,EACnB;AAAA;AAAA;AAAA;AAAA,EAKA,YAAoB;AAClB,WAAO,KAAK;AAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,SAAS,MAKS;AACtB,QAAI;AAEF,YAAM,qBAAqB,KAAK,SAAS,SAAS,KAAK,QAAQ;AAC/D,UAAI,CAAC,mBAAmB,OAAO;AAC7B,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO,mBAAmB,OAAO,KAAK,IAAI;AAAA,QAC5C;AAAA,MACF;AAGA,YAAM,iBAAiB,MAAM,KAAK,SAAS,KAAK,KAAK,QAAQ;AAG7D,YAAM,OAAO,MAAM,KAAK,OAAO,KAAK,OAAO;AAAA,QACzC,MAAM;AAAA,UACJ,OAAO,KAAK,MAAM,YAAY;AAAA,UAC9B,UAAU;AAAA,UACV,MAAM,KAAK;AAAA,UACX,OAAO,KAAK;AAAA,QACd;AAAA,MACF,CAAC;AAGD,YAAM,SAAS,KAAK,IAAI,kBAAkB,IAAI;AAG9C,YAAM,KAAK,cAAc,KAAK,IAAI,OAAO,YAAY;AAGrD,UAAI,KAAK,OAAO,OAAO,eAAe;AACpC,cAAM,KAAK,OAAO,MAAM,cAAc,IAAI;AAAA,MAC5C;AAEA,aAAO;AAAA,QACL,SAAS;AAAA,QACT;AAAA,QACA,aAAa,OAAO;AAAA,QACpB,cAAc,OAAO;AAAA,MACvB;AAAA,IACF,SAAS,OAAY;AACnB,UAAI,MAAM,SAAS,SAAS;AAC1B,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACF;AAEA,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,MAAM,aAAuE;AACjF,QAAI;AAEF,YAAM,OAAO,MAAM,KAAK,OAAO,KAAK,WAAW;AAAA,QAC7C,OAAO,EAAE,OAAO,YAAY,MAAM,YAAY,EAAE;AAAA,MAClD,CAAC;AAED,UAAI,CAAC,QAAQ,CAAC,KAAK,UAAU;AAC3B,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACF;AAGA,YAAM,kBAAkB,MAAM,KAAK,SAAS,OAAO,YAAY,UAAU,KAAK,QAAQ;AACtF,UAAI,CAAC,iBAAiB;AACpB,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACF;AAGA,YAAM,KAAK,OAAO,KAAK,OAAO;AAAA,QAC5B,OAAO,EAAE,IAAI,KAAK,GAAG;AAAA,QACrB,MAAM,EAAE,aAAa,oBAAI,KAAK,EAAE;AAAA,MAClC,CAAC;AAGD,YAAM,SAAS,KAAK,IAAI,kBAAkB,IAAI;AAG9C,YAAM,KAAK,cAAc,KAAK,IAAI,OAAO,YAAY;AAGrD,UAAI,KAAK,OAAO,OAAO,SAAS;AAC9B,cAAM,UAAU,MAAM,KAAK,yBAAyB,OAAO,YAAY;AACvE,cAAM,KAAK,OAAO,MAAM,QAAQ,MAAM,OAAO;AAAA,MAC/C;AAEA,aAAO;AAAA,QACL,SAAS;AAAA,QACT;AAAA,QACA,aAAa,OAAO;AAAA,QACpB,cAAc,OAAO;AAAA,MACvB;AAAA,IACF,SAAS,OAAO;AACd,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,YAAY,OAAqC;AACrD,QAAI;AACF,YAAM,UAAU,KAAK,IAAI,kBAAkB,KAAK;AAChD,UAAI,CAAC,QAAS,QAAO;AAErB,YAAM,OAAO,MAAM,KAAK,OAAO,KAAK,WAAW;AAAA,QAC7C,OAAO,EAAE,IAAI,QAAQ,OAAO;AAAA,MAC9B,CAAC;AAED,aAAO;AAAA,IACT,SAAS,OAAO;AACd,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,aAAa,cAA2C;AAC5D,QAAI;AACF,YAAM,UAAU,MAAM,KAAK,yBAAyB,YAAY;AAChE,UAAI,CAAC,WAAW,QAAQ,YAAY,oBAAI,KAAK,GAAG;AAC9C,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACF;AAEA,YAAM,OAAO,MAAM,KAAK,OAAO,KAAK,WAAW;AAAA,QAC7C,OAAO,EAAE,IAAI,QAAQ,OAAO;AAAA,MAC9B,CAAC;AAED,UAAI,CAAC,MAAM;AACT,eAAO;AAAA,UACL,SAAS;AAAA,UACT,OAAO;AAAA,QACT;AAAA,MACF;AAGA,YAAM,SAAS,KAAK,IAAI,kBAAkB,IAAI;AAG9C,YAAM,KAAK,OAAO,QAAQ,OAAO;AAAA,QAC/B,OAAO,EAAE,IAAI,QAAQ,GAAG;AAAA,QACxB,MAAM;AAAA,UACJ,cAAc,OAAO;AAAA,UACrB,WAAW,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,OAAO,SAAU,aAAc;AAAA,QACvE;AAAA,MACF,CAAC;AAED,aAAO;AAAA,QACL,SAAS;AAAA,QACT;AAAA,QACA,aAAa,OAAO;AAAA,QACpB,cAAc,OAAO;AAAA,MACvB;AAAA,IACF,SAAS,OAAO;AACd,aAAO;AAAA,QACL,SAAS;AAAA,QACT,OAAO;AAAA,MACT;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAM,OAAO,cAAwC;AACnD,QAAI;AACF,YAAM,UAAU,MAAM,KAAK,yBAAyB,YAAY;AAChE,UAAI,SAAS;AACX,cAAM,KAAK,OAAO,QAAQ,OAAO;AAAA,UAC/B,OAAO,EAAE,IAAI,QAAQ,GAAG;AAAA,QAC1B,CAAC;AAGD,YAAI,KAAK,OAAO,OAAO,UAAU;AAC/B,gBAAM,KAAK,OAAO,MAAM,SAAS,QAAQ,MAAM;AAAA,QACjD;AAAA,MACF;AAEA,aAAO;AAAA,IACT,SAAS,OAAO;AACd,aAAO;AAAA,IACT;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,YAAY,UAAiC,CAAC,GAA8D;AAC1G,WAAO,CAAC,KAAc,KAAe,SAAuB;AAC1D,OAAC,YAAY;AACX,YAAI;AACF,gBAAM,QAAQ,KAAK,aAAa,GAAG;AACnC,cAAI,CAAC,OAAO;AACV,gBAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,oBAAoB,CAAC;AACnD;AAAA,UACF;AAEA,gBAAM,OAAO,MAAM,KAAK,YAAY,KAAK;AACzC,cAAI,CAAC,MAAM;AACT,gBAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,gBAAgB,CAAC;AAC/C;AAAA,UACF;AAGA,cAAI,QAAQ,QAAQ,KAAK,SAAS,QAAQ,MAAM;AAC9C,gBAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,2BAA2B,CAAC;AAC1D;AAAA,UACF;AAEA,cAAI,QAAQ,SAAS,CAAC,QAAQ,MAAM,SAAS,KAAK,IAAK,GAAG;AACxD,gBAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,2BAA2B,CAAC;AAC1D;AAAA,UACF;AAGA,cAAI,QAAQ,iBAAiB,CAAC,KAAK,eAAe;AAChD,gBAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,qBAAqB,CAAC;AACpD;AAAA,UACF;AAEA,UAAC,IAAY,OAAO;AACpB,eAAK;AAAA,QACP,SAAS,OAAO;AACd,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,wBAAwB,CAAC;AAAA,QACzD;AAAA,MACF,GAAG;AAAA,IACL;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,eAA0E;AACxE,WAAO,CAAC,KAAc,KAAe,SAAuB;AAC1D,OAAC,YAAY;AACX,YAAI;AACF,gBAAM,QAAQ,KAAK,aAAa,GAAG;AACnC,cAAI,OAAO;AACT,kBAAM,OAAO,MAAM,KAAK,YAAY,KAAK;AACzC,gBAAI,MAAM;AACR,cAAC,IAAY,OAAO;AAAA,YACtB;AAAA,UACF;AACA,eAAK;AAAA,QACP,SAAS,OAAO;AAEd,eAAK;AAAA,QACP;AAAA,MACF,GAAG;AAAA,IACL;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,aAAa,KAA6B;AAEhD,UAAM,aAAa,IAAI,QAAQ;AAC/B,QAAI,cAAc,WAAW,WAAW,SAAS,GAAG;AAClD,aAAO,WAAW,UAAU,CAAC;AAAA,IAC/B;AAGA,UAAM,cAAc,IAAI,SAAS;AACjC,QAAI,aAAa;AACf,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,cAAc,QAAgB,cAAqC;AAC/E,UAAM,KAAK,OAAO,QAAQ,OAAO;AAAA,MAC/B,MAAM;AAAA,QACJ;AAAA,QACA;AAAA,QACA,WAAW,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,OAAO,SAAU,aAAc;AAAA,QACrE,WAAW;AAAA;AAAA,QACX,WAAW;AAAA;AAAA,MACb;AAAA,IACF,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,yBAAyB,cAAsB;AAC3D,WAAO,KAAK,OAAO,QAAQ,WAAW;AAAA,MACpC,OAAO,EAAE,aAAa;AAAA,IACxB,CAAC;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKQ,uBAA6B;AACnC,QAAI,KAAK,OAAO,YAAY,UAAU,OAAO,KAAK,OAAO,WAAW,WAAW,UAAU;AACvF,WAAK,MAAM,gBAAgB,KAAK,OAAO,WAAW,MAAM;AAAA,IAC1D;AAEA,QAAI,KAAK,OAAO,YAAY,UAAU,OAAO,KAAK,OAAO,WAAW,WAAW,UAAU;AACvF,WAAK,MAAM,gBAAgB,KAAK,OAAO,WAAW,MAAM;AAAA,IAC1D;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKQ,cAAoB;AAE1B,QAAI,KAAK,OAAO,UAAU,cAAc,SAAS;AAC/C,YAAM,cAAU,0BAAAC,SAAU;AAAA,QACxB,UAAU,KAAK,OAAO,SAAS,aAAa;AAAA,QAC5C,KAAK,KAAK,OAAO,SAAS,aAAa;AAAA,QACvC,SAAS,EAAE,OAAO,4CAA4C;AAAA,MAChE,CAAC;AACD,WAAK,OAAO,IAAI,UAAU,OAAO;AACjC,WAAK,OAAO,IAAI,aAAa,OAAO;AAAA,IACtC;AAGA,SAAK,OAAO,KAAK,aAAa,OAAO,KAAc,QAAkB;AACnE,YAAM,SAAS,MAAM,KAAK,SAAS,IAAI,IAAI;AAC3C,UAAI,OAAO,SAAS;AAClB,YAAI,OAAO,GAAG,EAAE,KAAK,MAAM;AAAA,MAC7B,OAAO;AACL,YAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,OAAO,MAAM,CAAC;AAAA,MAC9C;AAAA,IACF,CAAC;AAED,SAAK,OAAO,KAAK,UAAU,OAAO,KAAc,QAAkB;AAChE,YAAM,SAAS,MAAM,KAAK,MAAM,IAAI,IAAI;AACxC,UAAI,OAAO,SAAS;AAClB,YAAI,OAAO,GAAG,EAAE,KAAK,MAAM;AAAA,MAC7B,OAAO;AACL,YAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,OAAO,MAAM,CAAC;AAAA,MAC9C;AAAA,IACF,CAAC;AAED,SAAK,OAAO,KAAK,YAAY,OAAO,KAAc,QAAkB;AAClE,YAAM,EAAE,aAAa,IAAI,IAAI;AAC7B,YAAM,SAAS,MAAM,KAAK,aAAa,YAAY;AACnD,UAAI,OAAO,SAAS;AAClB,YAAI,OAAO,GAAG,EAAE,KAAK,MAAM;AAAA,MAC7B,OAAO;AACL,YAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,OAAO,MAAM,CAAC;AAAA,MAC9C;AAAA,IACF,CAAC;AAED,SAAK,OAAO,KAAK,WAAW,OAAO,KAAc,QAAkB;AACjE,YAAM,EAAE,aAAa,IAAI,IAAI;AAC7B,YAAM,UAAU,MAAM,KAAK,OAAO,YAAY;AAC9C,UAAI,OAAO,UAAU,MAAM,GAAG,EAAE,KAAK,EAAE,QAAQ,CAAC;AAAA,IAClD,CAAC;AAED,SAAK,OAAO,IAAI,OAAO,KAAK,YAAY,GAAG,OAAO,KAAc,QAAkB;AAChF,YAAM,UAAU;AAChB,UAAI,KAAK,EAAE,MAAM,QAAQ,KAAK,CAAC;AAAA,IACjC,CAAC;AAGD,QAAI,KAAK,OAAO;AACd,WAAK,OAAO,KAAK,sBAAsB,KAAK,YAAY,GAAG,OAAO,KAAc,QAAkB;AAChG,cAAM,UAAU;AAChB,cAAM,OAAO,QAAQ;AACrB,YAAI,KAAK,eAAe;AACtB,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,yBAAyB,CAAC;AACxD;AAAA,QACF;AAEA,cAAM,QAAQ,aAAa,cAAc;AACzC,cAAM,KAAK,OAAO,kBAAkB,OAAO;AAAA,UACzC,MAAM;AAAA,YACJ,QAAQ,KAAK;AAAA,YACb;AAAA,YACA,MAAM;AAAA,YACN,WAAW,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,KAAK,GAAI;AAAA;AAAA,UACtD;AAAA,QACF,CAAC;AAED,cAAM,UAAU,MAAM,KAAK,MAAO,sBAAsB,MAAM,KAAK;AACnE,YAAI,KAAK,EAAE,QAAQ,CAAC;AAAA,MACtB,CAAC;AAED,WAAK,OAAO,IAAI,wBAAwB,OAAO,KAAc,QAAkB;AAC7E,cAAM,EAAE,MAAM,IAAI,IAAI;AAEtB,cAAM,oBAAoB,MAAM,KAAK,OAAO,kBAAkB,WAAW;AAAA,UACvE,OAAO,EAAE,MAAM;AAAA,UACf,SAAS,EAAE,MAAM,KAAK;AAAA,QACxB,CAAC;AAED,YAAI,CAAC,qBAAqB,kBAAkB,SAAS,sBAAsB;AACzE,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,gBAAgB,CAAC;AAC/C;AAAA,QACF;AAEA,YAAI,kBAAkB,YAAY,oBAAI,KAAK,GAAG;AAC5C,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,gBAAgB,CAAC;AAC/C;AAAA,QACF;AAGA,cAAM,KAAK,OAAO,KAAK,OAAO;AAAA,UAC5B,OAAO,EAAE,IAAI,kBAAkB,OAAO;AAAA,UACtC,MAAM,EAAE,eAAe,KAAK;AAAA,QAC9B,CAAC;AAGD,cAAM,KAAK,OAAO,kBAAkB,OAAO;AAAA,UACzC,OAAO,EAAE,IAAI,kBAAkB,GAAG;AAAA,QACpC,CAAC;AAGD,YAAI,KAAK,OAAO,OAAO,iBAAiB;AACtC,gBAAM,KAAK,OAAO,MAAM,gBAAgB,kBAAkB,IAAI;AAAA,QAChE;AAEA,YAAI,KAAK,EAAE,SAAS,MAAM,SAAS,8BAA8B,CAAC;AAAA,MACpE,CAAC;AAGD,WAAK,OAAO,KAAK,oBAAoB,OAAO,KAAc,QAAkB;AAC1E,cAAM,EAAE,MAAM,IAAI,IAAI;AAEtB,YAAI,CAAC,aAAa,aAAa,KAAK,GAAG;AACrC,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,uBAAuB,CAAC;AACtD;AAAA,QACF;AAEA,cAAM,OAAO,MAAM,KAAK,OAAO,KAAK,WAAW;AAAA,UAC7C,OAAO,EAAE,MAAM;AAAA,QACjB,CAAC;AAED,YAAI,CAAC,MAAM;AAET,cAAI,KAAK,EAAE,SAAS,MAAM,SAAS,kDAAkD,CAAC;AACtF;AAAA,QACF;AAEA,cAAM,QAAQ,aAAa,cAAc;AACzC,cAAM,KAAK,OAAO,kBAAkB,OAAO;AAAA,UACzC,MAAM;AAAA,YACJ,QAAQ,KAAK;AAAA,YACb;AAAA,YACA,MAAM;AAAA,YACN,WAAW,IAAI,KAAK,KAAK,IAAI,IAAI,KAAK,KAAK,GAAI;AAAA;AAAA,UACjD;AAAA,QACF,CAAC;AAED,cAAM,UAAU,MAAM,KAAK,MAAO,kBAAkB,MAAM,KAAK;AAC/D,YAAI,KAAK,EAAE,QAAQ,CAAC;AAAA,MACtB,CAAC;AAED,WAAK,OAAO,KAAK,mBAAmB,OAAO,KAAc,QAAkB;AACzE,cAAM,EAAE,OAAO,SAAS,IAAI,IAAI;AAEhC,cAAM,oBAAoB,MAAM,KAAK,OAAO,kBAAkB,WAAW;AAAA,UACvE,OAAO,EAAE,MAAM;AAAA,UACf,SAAS,EAAE,MAAM,KAAK;AAAA,QACxB,CAAC;AAED,YAAI,CAAC,qBAAqB,kBAAkB,SAAS,kBAAkB;AACrE,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,gBAAgB,CAAC;AAC/C;AAAA,QACF;AAEA,YAAI,kBAAkB,YAAY,oBAAI,KAAK,GAAG;AAC5C,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,gBAAgB,CAAC;AAC/C;AAAA,QACF;AAGA,cAAM,qBAAqB,KAAK,SAAS,SAAS,QAAQ;AAC1D,YAAI,CAAC,mBAAmB,OAAO;AAC7B,cAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,mBAAmB,OAAO,KAAK,IAAI,EAAE,CAAC;AACpE;AAAA,QACF;AAGA,cAAM,iBAAiB,MAAM,KAAK,SAAS,KAAK,QAAQ;AAGxD,cAAM,KAAK,OAAO,KAAK,OAAO;AAAA,UAC5B,OAAO,EAAE,IAAI,kBAAkB,OAAO;AAAA,UACtC,MAAM,EAAE,UAAU,eAAe;AAAA,QACnC,CAAC;AAGD,cAAM,KAAK,OAAO,kBAAkB,OAAO;AAAA,UACzC,OAAO,EAAE,IAAI,kBAAkB,GAAG;AAAA,QACpC,CAAC;AAED,YAAI,KAAK,EAAE,SAAS,MAAM,SAAS,8BAA8B,CAAC;AAAA,MACpE,CAAC;AAAA,IACH;AAGA,QAAI,KAAK,OAAO,YAAY,UAAU,OAAO,KAAK,OAAO,WAAW,WAAW,UAAU;AACvF,WAAK,OAAO,IAAI,WAAW,KAAK,MAAM,aAAa,QAAQ,CAAC;AAC5D,WAAK,OAAO;AAAA,QAAI;AAAA,QACd,KAAK,MAAM,aAAa,UAAU,EAAE,SAAS,MAAM,CAAC;AAAA,QACpD,KAAK,oBAAoB,KAAK,IAAI;AAAA,MACpC;AAAA,IACF;AAEA,QAAI,KAAK,OAAO,YAAY,UAAU,OAAO,KAAK,OAAO,WAAW,WAAW,UAAU;AACvF,WAAK,OAAO,IAAI,WAAW,KAAK,MAAM,aAAa,QAAQ,CAAC;AAC5D,WAAK,OAAO;AAAA,QAAI;AAAA,QACd,KAAK,MAAM,aAAa,UAAU,EAAE,SAAS,MAAM,CAAC;AAAA,QACpD,KAAK,oBAAoB,KAAK,IAAI;AAAA,MACpC;AAAA,IACF;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA,MAAc,oBAAoB,KAAc,KAA8B;AAC5E,QAAI;AACF,YAAM,OAAQ,IAAY;AAC1B,UAAI,CAAC,MAAM;AACT,YAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,8BAA8B,CAAC;AAC7D;AAAA,MACF;AAGA,YAAM,SAAS,KAAK,IAAI,kBAAkB,IAAI;AAG9C,YAAM,KAAK,cAAc,KAAK,IAAI,OAAO,YAAY;AAGrD,UAAI,KAAK,OAAO,OAAO,SAAS;AAC9B,cAAM,UAAU,MAAM,KAAK,yBAAyB,OAAO,YAAY;AACvE,cAAM,KAAK,OAAO,MAAM,QAAQ,MAAM,OAAO;AAAA,MAC/C;AAEA,UAAI,KAAK;AAAA,QACP,SAAS;AAAA,QACT;AAAA,QACA,aAAa,OAAO;AAAA,QACpB,cAAc,OAAO;AAAA,MACvB,CAAC;AAAA,IACH,SAAS,OAAO;AACd,UAAI,OAAO,GAAG,EAAE,KAAK,EAAE,OAAO,wBAAwB,CAAC;AAAA,IACzD;AAAA,EACF;AAAA;AAAA,EAGA,OAAO,eAAe,UAAkB;AACtC,QAAI,CAAC,gBAAgB,gBAAgB,QAAQ,GAAG;AAC9C,YAAM,IAAI,MAAM,kCAAkC,QAAQ,EAAE;AAAA,IAC9D;AACA,WAAO,gBAAgB,SAAS,QAAe;AAAA,EACjD;AAAA,EAEA,OAAO,YAAY,UAAkB;AACnC,QAAI,CAAC,gBAAgB,gBAAgB,QAAQ,GAAG;AAC9C,YAAM,IAAI,MAAM,kCAAkC,QAAQ,EAAE;AAAA,IAC9D;AACA,WAAO,gBAAgB,oBAAoB,QAAe;AAAA,EAC5D;AAAA,EAEA,OAAO,sBAAsB,UAAkB;AAC7C,QAAI,CAAC,gBAAgB,gBAAgB,QAAQ,GAAG;AAC9C,YAAM,IAAI,MAAM,kCAAkC,QAAQ,EAAE;AAAA,IAC9D;AACA,WAAO,gBAAgB,sBAAsB,QAAe;AAAA,EAC9D;AAAA,EAEA,OAAO,wBAAwB;AAC7B,WAAO,gBAAgB,sBAAsB;AAAA,EAC/C;AACF;","names":["jwt","bcrypt","passport","GoogleStrategy","GitHubStrategy","nodemailer","rateLimit"]}